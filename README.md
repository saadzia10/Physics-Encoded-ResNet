# Paper Implementation: Physics Encoded Blocks in Residual Neural Network Architectures for Digital Twin Models

## Abstract

Physics Informed Machine Learning has emerged as a popular approach for modelling and simulation in digital twins, enabling the generation of accurate models of processes and behaviours in real-world systems. However, existing methods either rely on simple loss regularizations that offer limited physics integration or employ highly specialised architectures that are difficult to generalise across diverse physical systems. This paper presents a generic approach based on a novel physics-encoded residual neural network (PERNN) architecture that seamlessly combines data-driven and physics-based analytical models to overcome these limitations. Our method integrates differentiable physics blocks—implementing mathematical operators from physics-based models—with feed-forward learning blocks, while intermediate residual blocks ensure stable gradient flow during training. Consequently, the model naturally adheres to the underlying physical principles even when prior physics knowledge is incomplete, thereby improving generalizability with low data requirements and reduced model complexity. We investigate our approach in two application domains. The first is a steering model for autonomous vehicles in a simulation environment, and the second is a digital twin for climate modelling using an ordinary differential equation (ODE)-based model of Net Ecosystem Exchange (NEE) to enable gap-filling in flux tower data. In both cases, our method outperforms conventional neural network approaches as well as state-of-the-art Physics Informed Machine Learning methods.


## Repository Description

The experiments are divided into two use-cases featuring `driving` and `climate` scenarios. The driving usecase involves training and deploying a driving agent in the [TORCS Driving Simulation](https://sourceforge.net/projects/torcs/). The climate usecase involves modelling CO2 emissions as Net Ecosystem Exchange using flux data and ordinary differential equation.
